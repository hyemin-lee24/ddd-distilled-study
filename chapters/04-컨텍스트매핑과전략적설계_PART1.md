# 04. 컨텍스트 매핑과 전략적 설계

## 이 장의 구성

1. 매핑의 종류
2. 컨텍스트 매핑 활용하기
3. 컨텍스트 매핑 사례

※ 이 장에서는 **"1. 매핑의 종류"만 정리한 내용**입니다.



## 컨텍스트 매핑이란?

- 애자일 프로젝트 관리의 **핵심 도메인**은 다른 바운디드 컨텍스트들과 **통합**되어야 하며,
   DDD에서는 이러한 통합 작업을 **컨텍스트 매핑(Context Mapping)**이라고 한다.
- 예: `Discussion`이라는 개념이 두 개의 서로 다른 바운디드 컨텍스트에 존재할 수 있다.
   이때 어떤 컨텍스트가 **소비 주체**이고, 어떤 컨텍스트가 **근원**인지 파악해야 한다.
- 다이어그램 상에서는 **바운디드 컨텍스트 간의 연결선**으로 매핑을 표현하며,
   이 선은 단순한 통합뿐만 아니라, **보편 언어 간 통역**, **팀 간 협력 관계**도 함께 나타낸다.



## 1. 매핑의 종류

### 파트너십

- **공동 목표**를 위해 밀접하게 협력하는 두 팀 간의 관계
- **함께 성공하거나 함께 실패**함
- 일정 조율, 모델 통합 등에 **지속적인 협력** 필요
- 팀 간 **굵은 매핑 선**으로 표현
- **의존성이 줄어들 경우**, 다른 매핑 형태로 전환 필요

------

### 공유 커널 (Shared Kernel)

- 두 팀이 **일부 공통 모델**을 공유
- 모델 공유에는 **명확한 합의와 지속적인 협업**이 필요
- 변경 시에도 **동기화와 소통**을 지속해야 함
- **작지만 중요한 영역**에서 주로 활용

------

### 고객-공급자

- 상류(공급자, Upstream) ↔ 하류(고객, Downstream) 관계
- 공급자는 **고객 요구를 수용**하지만, **일정과 내용은 공급자가 결정**
- 고객은 공급자의 계획에 따라 **예측적이고 수동적으로 대처**
- 관계의 주도권은 **공급자에 있음**

------

### 준수자 (Conformist)

- 상류 팀은 하류 팀 요구를 **반영할 의지 없음**
- 하류 팀은 상류 팀의 모델을 **그대로 따라야 함**
- **모델 독립성 없음**, 상류 모델에 **전적으로 종속**
- 하류 입장에서 **가장 수동적이고 불리한 형태**

------

### 반부패 계층 (Anticorruption Layer)

- **방어적 통합 전략**
- 하류 팀이 **상류 모델과의 직접 통합을 회피**하고,
   **중간에 번역 계층**을 만들어 자체 모델 보호
- 이 계층은 모델 독립성을 유지하며, **특정 요구에 맞춘 통합 방식 구현 가능**
- 단점: **복잡도와 비용 증가**

------

### 공개 호스트 서비스 (Open Host Service)

- 바운디드 컨텍스트가 **공개된 통합 인터페이스/프로토콜** 제공
- 누구든지 해당 서비스와 **표준화된 방식으로 통합 가능**
- 통합 진입 장벽이 낮고, 외부 팀이나 시스템에 **접근성 높음**

------

### 공표된 언어

- 시스템 간 정보 교환을 위한 **표준화된 문서 기반 언어**
   예: XML, JSON Schema, Protobuf, Avro 등
- 명확한 스키마 제공 → 다양한 컨텍스트 간 **언어 번역 용이**
- 종종 **공개 호스트 서비스와 함께 사용**

------

### 각자의 길 (Separate Ways)

- 바운디드 컨텍스트 통합이 **의미 없거나 불필요**한 경우
- 각자 **독립적으로 문제를 해결**하고 통합은 시도하지 않음
- 보편 언어를 억지로 맞추기보다는 **별도 유지가 더 효과적**

------

### 큰 진흙 덩어리

- **구조화되지 않은 레거시 시스템**과의 통합 문제
- 문제점:
  - 잘못된 의존과 연결로 인해 시스템이 계속 망가짐
  - 하나를 수정하면 다른 문제가 발생
  - **전체를 이해하는 전문가** 없이는 유지 곤란
- 대응 방안: **반부패 계층(ACL)**을 사용해 **도메인 모델 보호**